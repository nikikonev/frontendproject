<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IDB Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2rem; }
        .log { margin-bottom: 0.5rem; }
        pre { background: #f5f5f5; padding: 1rem; border-radius: 5px; }
    </style>
</head>
<body>
<h1>IDB.js Test</h1>
<div id="output"></div>

<script src="idb.js"></script>
<script>
    function log(message) {
        console.log(message);
        const out = document.getElementById("output");
        const div = document.createElement("div");
        div.className = "log";
        div.textContent = message;
        out.appendChild(div);
    }

    function logObject(obj) {
        console.log(obj);
        const out = document.getElementById("output");
        const pre = document.createElement("pre");
        pre.textContent = JSON.stringify(obj, null, 2);
        out.appendChild(pre);
    }

    async function test() {
        try {
            const db = await idb.openCostsDB("costsdb", 1);

            await db.addCost({ sum: 200, currency: "USD", category: "FOOD", description: "pizza" });
            await db.addCost({ sum: 400, currency: "USD", category: "CAR", description: "fuel" });

            log("Costs added successfully.");

            // Fetch a report for current month/year in USD
            const now = new Date();
            const report = await db.getReport(now.getFullYear(), now.getMonth() + 1, "USD");

            log("Report returned:");
            logObject(report);

        } catch (e) {
            log("Error: " + e.message);
        }
    }

    test();
</script>
</body>
</html>
